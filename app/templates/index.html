<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XR Health - Medical Imaging Analysis</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="app-container">
        <!-- Top Navigation Bar -->
        <header class="top-bar">
            <div class="logo">
                <i class="fas fa-heartbeat"></i>
                <span>XR Health</span>
            </div>
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search patients, scans...">
            </div>
            <div class="top-controls">
                <button class="btn-secondary">
                    <i class="fas fa-plus"></i>
                    Add New Scan
                </button>
                <button class="btn-secondary">
                    <i class="fas fa-user"></i>
                    Profile
                </button>
            </div>
        </header>

        <div class="main-content">
            <!-- Left Sidebar - Tools -->
            <aside class="sidebar left-sidebar">
                <div class="tool-section">
                    <h3><i class="fas fa-cog"></i> Investigation Type</h3>
                    <select class="medical-select">
                        <option value="auto">Automatically</option>
                        <option value="manual">Manual Analysis</option>
                    </select>
                </div>
            </aside>

            <!-- Central Image Viewer -->
            <main class="image-viewer">
                <div class="viewer-header">
                    <h2><i class="fas fa-x-ray"></i> Chest X-Ray Analysis</h2>
                    <div class="viewer-controls">
                        <button class="btn-primary" id="analyzeBtn" style="display: none;">
                            <i class="fas fa-brain"></i>
                            Analyze Image
                        </button>
                        <button class="btn-secondary" id="freshAnalyzeBtn" style="display: none;">
                            <i class="fas fa-sync-alt"></i>
                            Fresh Analysis
                        </button>
                        <button class="btn-secondary" id="resetView">
                            <i class="fas fa-home"></i>
                            Reset View
                        </button>
                    </div>
                </div>

                <div class="image-container" id="imageContainer">
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-content">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <h3>Upload Medical Image</h3>
                            <p>Drag and drop your X-ray image here or click to browse</p>
                            <button class="btn-primary" id="browseBtn">
                                <i class="fas fa-folder-open"></i>
                                Browse Files
                            </button>
                        </div>
                        <input type="file" id="fileInput" accept="image/*" style="display: none;">
                        
                        <!-- Hidden form for analysis -->
                        <form id="freshAnalysisForm" action="{{ url_for('main.analyze') }}" method="post" enctype="multipart/form-data" style="display: none;">
                            <input type="file" name="xray_image" id="freshFileInput" accept="image/*">
                            <input type="text" name="symptoms" id="symptomsInput" placeholder="Patient symptoms (optional)">
                            <input type="text" name="patient_age" id="ageInput" placeholder="Patient age (optional)">
                            <select name="patient_gender" id="genderInput">
                                <option value="">Select gender (optional)</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                            <textarea name="medical_history" id="historyInput" placeholder="Medical history (optional)"></textarea>
                        </form>
                    </div>
                </div>

                <div class="image-info">
                    <div class="info-item">
                        <span class="label">Analysis Date:</span>
                        <span class="value" id="analysisDate">--</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Analysis Time:</span>
                        <span class="value" id="analysisTime">--</span>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar - Analysis & Patient Info -->
            <aside class="sidebar right-sidebar">
                <div class="analysis-section">
                    <h3><i class="fas fa-stethoscope"></i> AI Analysis Results</h3>
                    <div class="analysis-content" id="analysisResults">
                        <div class="placeholder-message">
                            <i class="fas fa-robot"></i>
                            <p>Upload an image to begin AI analysis</p>
                        </div>
                    </div>
                </div>

                <div class="patient-section">
                    <h3><i class="fas fa-user-injured"></i> Patient Information</h3>
                    <div class="patient-info">
                        <div class="info-row">
                            <span class="label">Patient ID:</span>
                            <span class="value">P-2024-001</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Date:</span>
                            <span class="value" id="currentDate">--</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Study Type:</span>
                            <span class="value">Chest X-Ray</span>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Loading Modal -->
    <div class="modal" id="loadingModal">
        <div class="modal-content">
            <div class="loading-spinner">
                <i class="fas fa-brain"></i>
            </div>
            <h3>AI Analysis in Progress</h3>
            <p>Analyzing medical image with advanced AI algorithms...</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>